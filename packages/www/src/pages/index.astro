---
import { actions } from "astro:actions";

const { data } = await Astro.callAction(
  actions.challenge.getCurrentDailyChallenge,
  {},
);

const result = Astro.getActionResult(actions.game.create);
if (result && !result.error) {
  return Astro.redirect(`/play/${result.data.gameId}`);
}
---

<div>
  <div>
    Daily C: {JSON.stringify(data)}

    <form method="POST" action={actions.game.create}>
      <input type="hidden" name="startMovieId" value={data?.startMovieId} />
      <input type="hidden" name="startPersonId" value={data?.startPersonId} />
      <input type="hidden" name="endMovieId" value={data?.endMovieId} />
      <input type="hidden" name="endPersonId" value={data?.endPersonId} />
      <button>Create Game</button>
    </form>
  </div>
</div>
